---
import { getCollection } from 'astro:content';

// Obtener todos los talleres ordenados
const talleres = await getCollection('talleres');
const talleresOrdenados = talleres.sort((a: any, b: any) => a.data.orden - b.data.orden);

// Renderizar el contenido de cada taller
const talleresContenido = await Promise.all(
    talleresOrdenados.map(async (taller) => {
        const { Content } = await taller.render();
        return {
            ...taller,
            Content
        };
    })
);

const baseUrl = import.meta.env.BASE_URL;
---

<section class="talleres">
    <div class="talleres-content">
        <header class="talleres-header">
            <h1>Talleres</h1>
        </header>
        
        <!-- Enlaces de navegaciÃ³n con iconos -->
        <nav class="talleres-nav">
            {talleresContenido.map((taller) => (
                <a href={`#${taller.slug}`} class="taller-nav-link">
                    <img 
                        src={`${baseUrl}icons/talleres/${taller.slug}.svg`} 
                        alt={taller.data.title}
                        class="taller-icon"
                    />
                </a>
            ))}
        </nav>
        
        <article class="talleres-list">
            {talleresContenido.map((taller) => (
                <section class="taller-item">
                    <h2 id={taller.slug}>{taller.data.title}</h2>
                    
                    {taller.data.edades && (
                        <p class="taller-info">
                            <strong>Edades:</strong> {taller.data.edades}
                        </p>
                    )}
                    <taller.Content />
                </section>
            ))}
        </article>
    </div>
</section>
